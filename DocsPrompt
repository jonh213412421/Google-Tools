  function onOpen() {
  DocumentApp.getUi()
      .createMenu('Custom Menu')
      .addItem('Run', 'verificarfuncs')
      .addToUi();
}

function verificarfuncs() {
  const doc = DocumentApp.getActiveDocument();
  const body = doc.getBody();
  const Prompt = body.getParagraphs()[0].getText();
  const comando = Prompt.trim().split(' ')[0];
  const args = Prompt.trim().split(' ').slice(1);
  
  // Verifica se o texto contém "oi"
  if (comando === "oi") {
    // Adiciona uma nova linha com "olá"
    body.appendParagraph("olá");
    body.appendParagraph(args.join(' '));
  }
  if (comando === "limpar") {
    // Adiciona uma nova linha com "olá"
    body.clear();
  }
  if (comando === "url") {
    //extrai página
    const url = args.join(' ');
    //acessa página e retorna texto
    const resposta = UrlFetchApp.fetch(url);
    const conteudo = resposta.getContentText();
    body.appendParagraph(conteudo);
  }
  // Comando "download"
  if (comando === "download") {
  const url = args.join(' ');

  try {
    // Faz o download do conteúdo
    const resposta = UrlFetchApp.fetch(url);
    const blob = resposta.getBlob(); // Obtém o conteúdo como Blob

    // Armazena o arquivo temporariamente no Google Drive
    const file = DriveApp.createFile(blob);
    const fileId = file.getId();
    const fileUrl = file.getUrl();
    body.appendParagraph(fileUrl);
    body.appendParagraph();
    // Lê o conteúdo do arquivo
    const conteudo = file.getBlob().getBytes();

    // Converte o conteúdo para hexadecimal
    const hex = toHex(conteudo);
    body.appendParagraph(hex); // Adiciona o hexadecimal ao documento

    // Remove o arquivo temporário
    //DriveApp.getFileById(fileId).setTrashed(true);

  } catch (e) {
    Logger.log('Erro ao buscar URL: ' + e.message);
    body.appendParagraph('Erro ao buscar URL: ' + e.message);
  }
  }
    function toHex(bytes) {
  return Array.from(bytes)
    .map(byte => ('0' + (byte & 0xFF).toString(16)).slice(-2))
    .join('');
}
}
